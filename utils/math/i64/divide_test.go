package i64

import (
	. "github.com/onsi/gomega"
	"testing"
)

func TestGetDividePlan(t *testing.T) {
	RegisterTestingT(t)

	datas := []struct {
		totalAmount int64
		amountArray []int64
		ownArray    []int64
		ok          bool
		plan        []int64
	}{
		// 数据错误
		{100, []int64{1}, []int64{}, false, nil},
		{100, []int64{1}, []int64{1, 2}, false, nil},

		{9901, []int64{100, 1000, 10000, 30000}, []int64{9, 9, 0, 0}, false, nil},
		{9900, []int64{100, 1000, 10000, 30000}, []int64{9, 9, 0, 0}, true, []int64{9, 9, 0, 0}},
		{9899, []int64{100, 1000, 10000, 30000}, []int64{9, 9, 0, 0}, true, []int64{9, 9, 0, 0}},

		{12501, []int64{100, 1000, 10000, 30000}, []int64{5, 2, 1, 0}, false, nil},
		{12500, []int64{100, 1000, 10000, 30000}, []int64{5, 2, 1, 0}, true, []int64{5, 2, 1, 0}},
		{10500, []int64{100, 1000, 10000, 30000}, []int64{5, 2, 1, 0}, true, []int64{5, 0, 1, 0}},
		{11500, []int64{100, 1000, 10000, 30000}, []int64{5, 2, 1, 0}, true, []int64{5, 1, 1, 0}},
		{11600, []int64{100, 1000, 10000, 30000}, []int64{5, 2, 1, 0}, true, []int64{0, 2, 1, 0}},

		{99, []int64{100, 1000, 10000, 30000}, []int64{2, 2, 2, 2}, true, []int64{1, 0, 0, 0}},
		{199, []int64{100, 1000, 10000, 30000}, []int64{2, 2, 2, 2}, true, []int64{2, 0, 0, 0}},
		{299, []int64{100, 1000, 10000, 30000}, []int64{2, 2, 2, 2}, true, []int64{0, 1, 0, 0}},

		{1099, []int64{100, 1000, 10000, 30000}, []int64{2, 2, 2, 2}, true, []int64{1, 1, 0, 0}},
		{1199, []int64{100, 1000, 10000, 30000}, []int64{2, 2, 2, 2}, true, []int64{2, 1, 0, 0}},
		{1299, []int64{100, 1000, 10000, 30000}, []int64{2, 2, 2, 2}, true, []int64{0, 2, 0, 0}},

		{2099, []int64{100, 1000, 10000, 30000}, []int64{2, 2, 2, 2}, true, []int64{1, 2, 0, 0}},
		{2199, []int64{100, 1000, 10000, 30000}, []int64{2, 2, 2, 2}, true, []int64{2, 2, 0, 0}},
		{2299, []int64{100, 1000, 10000, 30000}, []int64{2, 2, 2, 2}, true, []int64{0, 0, 1, 0}},

		{82200, []int64{100, 1000, 10000, 30000}, []int64{2, 2, 2, 2}, true, []int64{2, 2, 2, 2}},
		{82201, []int64{100, 1000, 10000, 30000}, []int64{2, 2, 2, 2}, false, nil},
	}

	for _, d := range datas {
		ok, plan := GetDividePlan(d.totalAmount, d.amountArray, d.ownArray)
		Ω(ok).Should(Equal(d.ok))
		Ω(plan).Should(Equal(d.plan))
	}
}
